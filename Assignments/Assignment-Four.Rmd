---
title: "Assignment for Week Four"
author: "Data and Computing Fundamentals"
date: "Macalester College"
output:
  html_document:
    css: ~/KaplanFiles/DCF-2014/CSS/DCF-style.css
    fig_caption: yes
    toc: no
---

```{r child="/Users/kaplan/KaplanFiles/DCF-2014/CSS/DCF-common.Rmd"}
```

## State by State

Using the `ZipGeography` data table, answer the following questions.  In addition to the answer itself, show the statement that you used and the data table created by your statement that contains the answer.

* How many different counties are there?
* Which city names are used in the most states?
* Which city names with more than 5% of the state population are used in the most states?
* Does any state have more than one time zone?
* Does any city have more than one time zone? 
* Does any county have more than one time zone?

## Babies and the Bible  

You can access a list of bible-related first names with this command:
```{r}
BibleNames <- fetchData("DCF/BibleNames.csv")
```

It looks like this:
```{r echo=FALSE}
head(BibleNames)
```

1. Using `BibleNames` and `BabyNames` ...
    * Create a data table, `BibleCount`, that gives, for each sex and each year, the number of babies born with bible-related names.  
    * Make a meaningful graphic from `BibleCount` displaying this.
    * Create a data table, `BibleGirls` that lists biblical names that are used primarily for girls.

## Gender-Neutral Names

The `BabyNames` data table looks like this:
```{r echo=FALSE}
Small <- sample_n(BabyNames, size=100000)
rownames(Small) <- NULL
head(Small,6)
```



Turn this into a wide-format table that looks like this:
```{r echo=FALSE}
Small %>% 
  spread( key=sex, value=count ) %>%
  filter( M>5, F>5) %>%
  head()
```

Your statement will have the following form: you have to fill in the variable name to replace ???
```
BothSexes <-
  BabyNames %>%
  spread( key=???, value=count ) %>%
  filter( F>1, M>1 )
```

Now that you have `BothSexes` ... 

1. Find the 10 names with the closest balance between females and males.  You can define gender-balance quantitatively as `abs(log(F/M))`.  The smaller this number, the more balanced the name count.
2. Find the 10 names with the closest balance that have more than 100 babies of either sex.
3. **Extra Credit**. Find the 10 names with the closest balance that have lasting popularity.  Define lasting popularity as having more than 100 babies in at least 20 of the years.
4. **Extra Credit**.  Are there names that have switched gender over the years.  Find, for each year, the gender ratio.  Pull out ones where the maximum and minumum over the years differ by a large amount.  Then plot out over time.



```{r child="../CSS/DisqusTemplate.Rmd"}
```


